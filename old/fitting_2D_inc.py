import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit

x = [0.0, 1.5, 3.0, 4.5, 6.0, 7.5, 9.0, 10.5, 12.0, 13.5, 15.0, 16.5, 18.0, 19.5, 21.0, 22.5, 24.0, 25.5, 27.0, 28.5, 30.0, 31.5, 33.0, 34.5, 36.0, 37.5, 39.0, 40.5, 42.0, 43.5, 45.0, 46.5, 48.0, 49.5, 51.0, 52.5, 54.0, 55.5, 57.0, 58.5, 60.0, 61.5, 63.0, 64.5, 66.0, 67.5, 69.0, 70.5, 72.0, 73.5, 75.0, 76.5, 78.0, 79.5, 81.0, 82.5, 84.0, 85.5, 87.0, 88.5, 90.0, 91.5, 93.0, 94.5, 96.0, 97.5, 99.0, 100.5, 102.0, 103.5, 105.0, 106.5, 108.0, 109.5, 111.0, 112.5, 114.0, 115.5, 117.0, 118.5, 120.0, 121.5, 123.0, 124.5, 126.0, 127.5, 129.0, 130.5, 132.0, 133.5, 135.0, 136.5, 138.0, 139.5, 141.0, 142.5, 144.0, 145.5, 147.0, 148.5, 150.0, 151.5, 153.0, 154.5, 156.0, 157.5, 159.0, 160.5, 162.0, 163.5, 165.0, 166.5, 168.0, 169.5, 171.0, 172.5, 174.0, 175.5, 177.0, 178.5, 180.0, 181.5, 183.0, 184.5, 186.0, 187.5, 189.0, 190.5, 192.0, 193.5, 195.0, 196.5, 198.0, 199.5, 201.0, 202.5, 204.0, 205.5, 207.0, 208.5, 210.0, 211.5, 213.0, 214.5, 216.0, 217.5, 219.0, 220.5, 222.0, 223.5, 225.0, 226.5, 228.0, 229.5, 231.0, 232.5, 234.0, 235.5, 237.0, 238.5, 240.0, 241.5, 243.0, 244.5, 246.0, 247.5, 249.0, 250.5, 252.0, 253.5, 255.0, 256.5, 258.0, 259.5, 261.0, 262.5, 264.0, 265.5, 267.0, 268.5, 270.0, 271.5, 273.0, 274.5, 276.0, 277.5, 279.0, 280.5, 282.0, 283.5, 285.0, 286.5, 288.0, 289.5, 291.0, 292.5, 294.0, 295.5, 297.0, 298.5]
x_2 = [np.power(x, 2) for x in x]
y = [1.0, 3.0, 3.0, 3.0, 3.0, 7.0, 7.0, 3.0, 7.0, 11.0, 11.0, 3.0, 7.0, 11.0, 15.0, 3.0, 7.0, 15.0, 19.0, 7.0, 7.0, 11.0, 19.0, 7.0, 11.0, 15.0, 19.0, 11.0, 19.0, 15.0, 15.0, 7.0, 19.0, 15.0, 27.0, 11.0, 15.0, 19.0, 27.0, 3.0, 11.0, 19.0, 27.0, 11.0, 19.0, 19.0, 35.0, 7.0, 15.0, 23.0, 23.0, 19.0, 23.0, 15.0, 27.0, 15.0, 31.0, 11.0, 19.0, 15.0, 27.0, 15.0, 27.0, 23.0, 31.0, 19.0, 27.0, 19.0, 31.0, 19.0, 31.0, 15.0, 27.0, 23.0, 43.0, 3.0, 23.0, 31.0, 35.0, 3.0, 23.0, 39.0, 39.0, 15.0, 27.0, 27.0, 39.0, 19.0, 35.0, 27.0, 31.0, 11.0, 31.0, 15.0, 43.0, 23.0, 31.0, 15.0, 39.0, 23.0, 31.0, 31.0, 47.0, 27.0, 23.0, 35.0, 47.0, 3.0, 35.0, 27.0, 35.0, 11.0, 35.0, 35.0, 51.0, 19.0, 35.0, 19.0, 39.0, 19.0, 35.0, 27.0, 39.0, 35.0, 47.0, 11.0, 31.0, 19.0, 55.0, 31.0, 35.0, 27.0, 43.0, 35.0, 55.0, 11.0, 35.0, 31.0, 51.0, 11.0, 27.0, 39.0, 55.0, 3.0, 27.0, 51.0, 71.0, 31.0, 35.0, 43.0, 55.0, 19.0, 43.0, 15.0, 55.0, 23.0, 35.0, 39.0, 43.0, 11.0, 39.0, 27.0, 55.0, 31.0, 43.0, 35.0, 59.0, 35.0, 47.0, 35.0, 43.0, 27.0, 47.0, 27.0, 67.0, 19.0, 43.0, 35.0, 51.0, 19.0, 35.0, 23.0, 51.0, 39.0, 63.0, 31.0, 43.0, 31.0, 71.0, 23.0, 31.0, 35.0, 71.0, 15.0, 35.0, 39.0, 67.0, 31.0, 55.0, 23.0]

# # sub-linear 함수 정의
def sub_linear(x, a, b, c):
    return a * np.power(x, b) + c  # y = a * x^b 일단 y절편 = 0

# 파라미터 초기값 설정
initial_params = [2, 2/3, 1]

# curve_fit 함수를 사용하여 데이터 fitting
params, params_covariance = curve_fit(sub_linear, x_2, y, p0=initial_params)

plt.plot(x_2, sub_linear(np.array(x_2), params[0], params[1], params[2]), label='Fitted function')
print(params)
print(params_covariance)

# 그래프 그리기
plt.plot(x_2, y, linestyle='dotted', marker='o')
plt.xlim(0, max(x_2) + 2)
plt.ylim(0, max(y) + 2)
plt.xlabel('x')
plt.ylabel('y')
plt.title('Graph')
plt.show()

